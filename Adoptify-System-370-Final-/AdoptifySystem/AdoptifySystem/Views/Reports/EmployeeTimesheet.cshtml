

@{
    ViewBag.Title = "EmployeeTimesheet1";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Employee Timesheet Report</h2>


<div class="criteria">
    <label>Date</label>
    <input type="date" id="InDate" class="btn btn-outline-dark" />
    <br />
    <br />
    <div class="btn-group">
        <button type="button" id="btnTo" value="Generate" class="btn btn-primary">Generate</button>
        <button type="button" class="btn btn-dark" id="btnPrint" style="float:right" onclick="printContent('CheckinReport');">Print</button>
    </div>

</div>
<hr style="background-color:dodgerblue" />
<div id="CheckinReport" style="border-radius:20px;background-color:rgb(0, 138, 255)">
    <h2 style="color:white"><span style="text-align:center">Employee Timesheet Report</span></h2>
    <table class="table table-striped table-dark" id="tblAdded">
        <thead>
            <tr>
                <th>Employee Name</th>
                <th>Employee Surname</th>
                <th>Check In</th>
                <th>Check Out</th>
            </tr>
        </thead>
        <tbody id="table1"> </tbody>
    </table>
</div>

@section Scripts{
    <script>
        $(document).ready(function ()
        {
            $("#btnPrint").attr("disabled", true);
            $('#btnTo').click(function ()
            {
                if (TDate()) {
               
                var Date = $('#InDate').val();
                $.ajax({
                    url: '/Reports/EmployeeTimesheet1',
                    type: "Post",
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify({ "Date": Date }),
                    success: function (data)
                    {
                        $('#tblAdded').find("tbody").empty();
                        console.log(data.VetName);
                        var i = 0;
                        var length = data.empName.length;
                        while (i < length)
                        {
                            var rowS = "<tr><td>" + data.empName[i] + "</td><td>" + data.empSurname[i] + "</td><td>" + data.checkIn[0] + "</td><td>" + data.checkOut[i] + "</td></tr>";
                            i++
                            $("#table1").append(rowS);
                        }
                        $("#btnPrint").attr("disabled", false);
                    },
                    error: function (xhr, ajaxoptions, thrownError)
                    {
                        alert(thrownError);
                    }
                }); }
            });       
        });
            function TDate() {
                var selectedDate = $('#InDate').val();
                var now = new Date();
                now.setHours(0, 0, 0, 0);
                if (new Date(selectedDate).getDate() > now.getDate())
                {
                    alert("The Date You Selected Has not Arrived lol");
                    return false;
                }
                if ($('#InDate').val().trim() == "")
                {
                    alert("Oops you Have not selected a Date");
                    return false;
                }
                    return true;
            };
    </script>
    <script>
        function printContent(el)
        {
            var retorepage = $('body').html();
            var printcontent = $('#' + el).clone();
            $('body').empty().html(printcontent);
            window.print();
            $('body').html(retorepage);
        }
    </script>
}


